<app-navbar [title]="'Detalle de Contacto'" [hrefDefault]="'/dashboard'" />

<ion-content [fullscreen]="true">
  <ion-header>
    <ion-toolbar>
      <ion-breadcrumbs class="breadcrumbs-left">
        <ion-breadcrumb routerLink="/dashboard">
          Contactos
          <ion-icon slot="separator" name="arrow-forward-circle"></ion-icon>
        </ion-breadcrumb>
        <ion-breadcrumb>
          Detalle de Contacto
          <ion-icon slot="separator" name="arrow-forward-circle"></ion-icon>
        </ion-breadcrumb>
      </ion-breadcrumbs>
    </ion-toolbar>
  </ion-header>
  <div class="container">
    <ion-img
      [src]="'https://ionicframework.com/docs/img/demos/avatar.svg'"
      alt="Foto de perfil"
    />
    <form [formGroup]="contactForm" (submit)="createContact()">
      <ion-item>
        <ion-label position="stacked">Nombre</ion-label>
        <ion-input
          formControlName="name"
          fill="outline"
          [clearInput]="true"
          [counter]="true"
          maxlength="50"
          type="text"
          placeholder="Jean Pierre"
        ></ion-input>

        @if(name?.invalid && (name?.dirty || name?.touched)){
        <ion-note color="danger">
          @if(name?.hasError('required')){ Nombre es requerido. }
          @if(name?.hasError('minlength')) { Debe tener mínimo 3 caracteres. }
          @if(name?.hasError('maxlength')) { Como máximo se permiten 50
          caracteres. }
        </ion-note>
        }
      </ion-item>
      <ion-item>
        <ion-label position="stacked">Telefono</ion-label>
        <ion-input
          formControlName="phone"
          fill="outline"
          [clearInput]="true"
          [counter]="true"
          maxlength="10"
          minlength="10"
          type="text"
          placeholder="0987654320"
        ></ion-input>
        @if(phone?.invalid && (phone?.dirty || phone?.touched)){
        <ion-note color="danger">
          @if(phone?.hasError('required')){ Telefono es requerido. }
          @if(phone?.hasError('minlength')) { Debe tener mínimo 10 caracteres. }
          @if(phone?.hasError('maxlength')) { Como máximo se permiten 10
          caracteres. } @if(phone?.hasError('pattern')) { Solo se permiten
          caracteres del 0-9. }
        </ion-note>
        }
      </ion-item>
      <ion-item>
        <ion-label position="stacked">Apodo (opcional)</ion-label>
        <ion-input
          formControlName="nickname"
          fill="outline"
          [clearInput]="true"
          [counter]="true"
          maxlength="50"
          type="text"
          placeholder="JP"
        ></ion-input>
        <ion-note color="danger">
          @if(nickname?.invalid && (nickname?.dirty || nickname?.touched)){
          <ion-note color="danger">
            @if(nickname?.hasError('minlength')) { Debe tener mínimo 10
            caracteres. } @if(nickname?.hasError('maxlength')) { Como máximo se
            permiten 10 caracteres. }
          </ion-note>
          }
        </ion-note>
      </ion-item>

      <div class="flex_button_register">
        <ion-button (click)="toggleEditMode()" [fill]="'outline'" type="button"
        [disabled]="contactForm.invalid && isEditMode"
        >
          <ion-icon name="pencil-outline"></ion-icon>
          {{ isEditMode ? 'Guardar' : 'Editar' }}
        </ion-button>
        <ion-button
          *ngIf="isEditMode"
          (click)="cancelEdit()"
          fill="outline"
          type="button"
          color="danger"
        >
          Cancelar
        </ion-button>
      </div>
      <div class="flex_button_favorites">
        <ion-button (click)="addFavorites()" color="warning" fill="outline">
          <ion-icon
            [name]="isContactFavorite?'star-half-outline':'star-outline'"
          ></ion-icon>
          {{isContactFavorite?'Quitar de':'Añadir a'}} Favoritos
        </ion-button>
      </div>
    </form>
  </div>
</ion-content>
